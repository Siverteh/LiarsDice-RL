2025-03-01 18:51:38,573 - curriculum - INFO - Starting enhanced curriculum learning for Liar's Dice
2025-03-01 18:51:38,574 - curriculum - INFO - Parameters: players=2, dice=3, faces=6
2025-03-01 18:51:38,574 - curriculum - INFO - Total curriculum episodes: 50000, distribution: progressive
2025-03-01 18:51:38,574 - curriculum - INFO - Self-play episodes: 10000, Population size: 5
2025-03-01 18:51:38,574 - curriculum - INFO - Network size: large, Learning rate: 0.0005
2025-03-01 18:51:39,683 - curriculum - INFO - Using device: cuda
2025-03-01 18:51:39,686 - curriculum - INFO - Observation dimension: 35
2025-03-01 18:51:39,687 - curriculum - INFO - Action dimension: 37
2025-03-01 18:51:41,040 - curriculum - INFO - Action mapping set with 37 possible actions
2025-03-01 18:51:41,041 - curriculum - INFO - Curriculum schedule:
2025-03-01 18:51:41,041 - curriculum - INFO -   Level 0 (random): 2500 episodes
2025-03-01 18:51:41,042 - curriculum - INFO -   Level 1 (naive): 7500 episodes
2025-03-01 18:51:41,042 - curriculum - INFO -   Level 2 (conservative): 10000 episodes
2025-03-01 18:51:41,042 - curriculum - INFO -   Level 3 (aggressive): 10000 episodes
2025-03-01 18:51:41,042 - curriculum - INFO -   Level 4 (strategic): 10000 episodes
2025-03-01 18:51:41,042 - curriculum - INFO -   Level 5 (adaptive): 10000 episodes
2025-03-01 18:51:41,042 - curriculum - INFO - 
=== Training against random (2500 episodes) ===
2025-03-01 18:51:41,042 - curriculum - INFO - Training against random for 2500 episodes
2025-03-01 18:51:47,774 - curriculum - INFO - Completed training against random
2025-03-01 18:51:47,774 - curriculum - INFO - Episodes: 2500, Duration: 6.73 seconds
2025-03-01 18:51:47,775 - curriculum - INFO - Final evaluation reward: 4.38
2025-03-01 18:51:47,775 - curriculum - INFO - Best win rate: 0.00
2025-03-01 18:51:47,781 - curriculum - INFO - Saved checkpoint to results\checkpoints\after_level_0
2025-03-01 18:51:48,329 - curriculum - INFO - 
=== Training against naive (7500 episodes) ===
2025-03-01 18:51:48,329 - curriculum - INFO - Training against naive for 7500 episodes
2025-03-01 18:51:52,546 - curriculum - INFO - Completed training against naive
2025-03-01 18:51:52,546 - curriculum - INFO - Episodes: 7500, Duration: 4.22 seconds
2025-03-01 18:51:52,546 - curriculum - INFO - Final evaluation reward: 3.00
2025-03-01 18:51:52,546 - curriculum - INFO - Best win rate: 0.00
2025-03-01 18:51:52,555 - curriculum - INFO - Saved checkpoint to results\checkpoints\after_level_1
2025-03-01 18:51:52,871 - curriculum - INFO - Evaluating against all previous levels...
2025-03-01 18:52:15,583 - curriculum - INFO -   vs random: win rate = 0.99
2025-03-01 18:52:38,573 - curriculum - INFO -   vs naive: win rate = 0.88
2025-03-01 18:52:38,573 - curriculum - INFO -   Average win rate across all levels: 0.93
2025-03-01 18:52:38,573 - curriculum - INFO - 
=== Training against conservative (10000 episodes) ===
2025-03-01 18:52:38,573 - curriculum - INFO - Training against conservative for 10000 episodes
2025-03-01 18:52:40,928 - curriculum - INFO - New best model for conservative: 0.03 win rate
2025-03-01 18:52:40,935 - curriculum - INFO - New best overall model: 0.03 win rate
2025-03-01 18:52:52,395 - curriculum - INFO - New best model for conservative: 0.20 win rate
2025-03-01 18:52:52,400 - curriculum - INFO - New best overall model: 0.20 win rate
2025-03-01 18:52:58,859 - curriculum - INFO - New best model for conservative: 0.30 win rate
2025-03-01 18:52:58,865 - curriculum - INFO - New best overall model: 0.30 win rate
2025-03-01 18:53:06,855 - curriculum - INFO - New best model for conservative: 0.40 win rate
2025-03-01 18:53:06,860 - curriculum - INFO - New best overall model: 0.40 win rate
2025-03-01 18:53:10,376 - curriculum - INFO - New best model for conservative: 0.43 win rate
2025-03-01 18:53:10,382 - curriculum - INFO - New best overall model: 0.43 win rate
2025-03-01 18:53:17,206 - curriculum - INFO - New best model for conservative: 0.60 win rate
2025-03-01 18:53:17,212 - curriculum - INFO - New best overall model: 0.60 win rate
2025-03-01 18:53:20,637 - curriculum - INFO - New best model for conservative: 0.63 win rate
2025-03-01 18:53:20,643 - curriculum - INFO - New best overall model: 0.63 win rate
2025-03-01 18:53:24,352 - curriculum - INFO - New best model for conservative: 0.73 win rate
2025-03-01 18:53:24,358 - curriculum - INFO - New best overall model: 0.73 win rate
2025-03-01 18:53:32,589 - curriculum - INFO - Loading best model for conservative (win rate: 0.73)
2025-03-01 18:53:33,013 - curriculum - INFO - Added conservative to mastered opponents: ['conservative']
2025-03-01 18:53:33,014 - curriculum - INFO - Completed training against conservative
2025-03-01 18:53:33,014 - curriculum - INFO - Episodes: 10000, Duration: 54.02 seconds
2025-03-01 18:53:33,014 - curriculum - INFO - Final evaluation reward: 1.02
2025-03-01 18:53:33,014 - curriculum - INFO - Best win rate: 0.73
2025-03-01 18:53:33,022 - curriculum - INFO - Saved checkpoint to results\checkpoints\after_level_2
2025-03-01 18:53:34,028 - curriculum - INFO - Evaluating against all previous levels...
2025-03-01 18:54:01,017 - curriculum - INFO -   vs random: win rate = 0.98
2025-03-01 18:54:27,558 - curriculum - INFO -   vs naive: win rate = 0.93
2025-03-01 18:54:53,959 - curriculum - INFO -   vs conservative: win rate = 0.47
2025-03-01 18:54:53,960 - curriculum - INFO -   Average win rate across all levels: 0.79
2025-03-01 18:54:53,960 - curriculum - INFO - 
=== Training against aggressive (10000 episodes) ===
2025-03-01 18:54:53,960 - curriculum - INFO - Note: Would mix in previous opponents ['conservative'], but API only supports one opponent type
2025-03-01 18:54:53,960 - curriculum - INFO - Consider adding support for multiple opponent types in future versions
2025-03-01 18:54:53,960 - curriculum - INFO - Training against aggressive for 10000 episodes
2025-03-01 18:54:53,960 - curriculum - INFO - Note: Progressive mixing with previous opponents is limited due to API constraints
2025-03-01 18:54:53,960 - curriculum - INFO - Using primary opponent: aggressive
2025-03-01 18:54:53,961 - curriculum - INFO - Adjusted learning rate to 0.00035 for level 3
2025-03-01 18:54:57,640 - curriculum - INFO - Completed training against aggressive
2025-03-01 18:54:57,640 - curriculum - INFO - Episodes: 10000, Duration: 3.68 seconds
2025-03-01 18:54:57,640 - curriculum - INFO - Final evaluation reward: 4.28
2025-03-01 18:54:57,640 - curriculum - INFO - Best win rate: 0.00
2025-03-01 18:54:57,647 - curriculum - INFO - Saved checkpoint to results\checkpoints\after_level_3
2025-03-01 18:54:57,968 - curriculum - INFO - Evaluating against all previous levels...
2025-03-01 18:55:22,750 - curriculum - INFO -   vs random: win rate = 0.99
2025-03-01 18:55:48,221 - curriculum - INFO -   vs naive: win rate = 0.96
2025-03-01 18:56:14,142 - curriculum - INFO -   vs conservative: win rate = 0.48
2025-03-01 18:56:39,937 - curriculum - INFO -   vs aggressive: win rate = 0.99
2025-03-01 18:56:39,938 - curriculum - INFO -   Average win rate across all levels: 0.86
2025-03-01 18:56:39,938 - curriculum - INFO - 
=== Training against strategic (10000 episodes) ===
2025-03-01 18:56:39,939 - curriculum - INFO - Note: Would mix in previous opponents ['conservative'], but API only supports one opponent type
2025-03-01 18:56:39,939 - curriculum - INFO - Consider adding support for multiple opponent types in future versions
2025-03-01 18:56:39,939 - curriculum - INFO - Training against strategic for 10000 episodes
2025-03-01 18:56:39,939 - curriculum - INFO - Note: Progressive mixing with previous opponents is limited due to API constraints
2025-03-01 18:56:39,939 - curriculum - INFO - Using primary opponent: strategic
2025-03-01 18:56:39,941 - curriculum - INFO - Adjusted learning rate to 0.000245 for level 4
2025-03-01 18:56:43,945 - curriculum - INFO - New best model for strategic: 0.70 win rate
2025-03-01 18:56:48,753 - curriculum - INFO - Loading best model for strategic (win rate: 0.70)
2025-03-01 18:56:48,770 - curriculum - INFO - Added strategic to mastered opponents: ['conservative', 'strategic']
2025-03-01 18:56:48,770 - curriculum - INFO - Completed training against strategic
2025-03-01 18:56:48,770 - curriculum - INFO - Episodes: 10000, Duration: 8.81 seconds
2025-03-01 18:56:48,770 - curriculum - INFO - Final evaluation reward: 2.15
2025-03-01 18:56:48,770 - curriculum - INFO - Best win rate: 0.70
2025-03-01 18:56:48,777 - curriculum - INFO - Saved checkpoint to results\checkpoints\after_level_4
2025-03-01 18:56:49,170 - curriculum - INFO - Evaluating against all previous levels...
2025-03-01 18:57:15,485 - curriculum - INFO -   vs random: win rate = 0.99
2025-03-01 18:57:42,028 - curriculum - INFO -   vs naive: win rate = 0.95
2025-03-01 18:58:08,499 - curriculum - INFO -   vs conservative: win rate = 0.46
2025-03-01 18:58:34,803 - curriculum - INFO -   vs aggressive: win rate = 0.98
2025-03-01 18:59:01,574 - curriculum - INFO -   vs strategic: win rate = 0.72
2025-03-01 18:59:01,575 - curriculum - INFO -   Average win rate across all levels: 0.82
2025-03-01 18:59:01,575 - curriculum - INFO - 
=== Training against adaptive (10000 episodes) ===
2025-03-01 18:59:01,575 - curriculum - INFO - Note: Would mix in previous opponents ['conservative', 'strategic'], but API only supports one opponent type
2025-03-01 18:59:01,576 - curriculum - INFO - Consider adding support for multiple opponent types in future versions
2025-03-01 18:59:01,576 - curriculum - INFO - Training against adaptive for 10000 episodes
2025-03-01 18:59:01,576 - curriculum - INFO - Note: Progressive mixing with previous opponents is limited due to API constraints
2025-03-01 18:59:01,576 - curriculum - INFO - Using primary opponent: adaptive
2025-03-01 18:59:01,577 - curriculum - INFO - Adjusted learning rate to 0.00017149999999999997 for level 5
2025-03-01 18:59:05,798 - curriculum - INFO - New best model for adaptive: 0.70 win rate
2025-03-01 18:59:10,741 - curriculum - INFO - Loading best model for adaptive (win rate: 0.70)
2025-03-01 18:59:10,798 - curriculum - INFO - Added adaptive to mastered opponents: ['conservative', 'strategic', 'adaptive']
2025-03-01 18:59:10,798 - curriculum - INFO - Completed training against adaptive
2025-03-01 18:59:10,798 - curriculum - INFO - Episodes: 10000, Duration: 9.16 seconds
2025-03-01 18:59:10,798 - curriculum - INFO - Final evaluation reward: 2.79
2025-03-01 18:59:10,799 - curriculum - INFO - Best win rate: 0.70
2025-03-01 18:59:10,805 - curriculum - INFO - Saved checkpoint to results\checkpoints\after_level_5
2025-03-01 18:59:11,127 - curriculum - INFO - Evaluating against all previous levels...
2025-03-01 18:59:38,279 - curriculum - INFO -   vs random: win rate = 0.98
2025-03-01 19:00:05,243 - curriculum - INFO -   vs naive: win rate = 0.97
2025-03-01 19:00:32,236 - curriculum - INFO -   vs conservative: win rate = 0.42
2025-03-01 19:00:59,185 - curriculum - INFO -   vs aggressive: win rate = 0.99
2025-03-01 19:01:25,723 - curriculum - INFO -   vs strategic: win rate = 0.80
2025-03-01 19:01:52,680 - curriculum - INFO -   vs adaptive: win rate = 0.83
2025-03-01 19:01:52,680 - curriculum - INFO -   Average win rate across all levels: 0.83
2025-03-01 19:01:52,680 - curriculum - INFO - 
=== Final Evaluation ===
2025-03-01 19:02:21,787 - curriculum - INFO - Saved final evaluation visualization to results\logs\final_evaluation.png
2025-03-01 19:02:21,815 - curriculum - INFO - Saved final model to results\models\liars_dice_dqn_20250301_190221_p2d3_wr0.80
2025-03-01 19:02:21,822 - curriculum - INFO - Saved final agent to results\checkpoints\final_agent
2025-03-01 19:02:21,823 - curriculum - INFO - 
Enhanced curriculum learning completed!
