2025-03-02 15:25:16,795 - train - INFO - Starting training for 5000 episodes with agent type: PPOAgent
2025-03-02 15:25:16,796 - train - INFO - Agent config: {'obs_dim': 35, 'action_dim': 37, 'hidden_dims': [256, 128, 64], 'learning_rate': 0.0005, 'min_learning_rate': 3e-05, 'gamma': 0.99, 'gae_lambda': 0.95, 'policy_clip': 0.2, 'value_coef': 0.5, 'entropy_coef': 0.01925, 'batch_size': 64, 'update_frequency': 2048, 'max_grad_norm': 0.5, 'update_counter': 2, 'step_counter': 1768, 'total_training_steps': 1000000, 'current_lr': 0.0004999805216592195, 'device': 'cuda', 'memory_size': 496, 'avg_policy_loss': 0.0, 'avg_value_loss': 0.0, 'avg_entropy': 0.0, 'avg_reward': 8.365000000000002}
2025-03-02 15:25:18,061 - train - INFO - Episode 100/5000 | Reward: -2.43 | Length: 6.29 | Loss: 0.0000
2025-03-02 15:25:19,204 - train - INFO - Evaluation at episode 100: -3.00 reward, Win rate: 0.07
2025-03-02 15:25:20,273 - train - INFO - Episode 200/5000 | Reward: -2.31 | Length: 6.04 | Loss: 0.0000
2025-03-02 15:25:21,537 - train - INFO - Evaluation at episode 200: -3.00 reward, Win rate: 0.10
2025-03-02 15:25:22,647 - train - INFO - Episode 300/5000 | Reward: -2.38 | Length: 6.24 | Loss: 0.0000
2025-03-02 15:25:23,897 - train - INFO - Evaluation at episode 300: -3.00 reward, Win rate: 0.03
2025-03-02 15:25:25,483 - train - INFO - Episode 400/5000 | Reward: -2.54 | Length: 6.16 | Loss: 0.0000
2025-03-02 15:25:26,652 - train - INFO - Evaluation at episode 400: 3.00 reward, Win rate: 0.17
2025-03-02 15:25:27,665 - train - INFO - Episode 500/5000 | Reward: -2.29 | Length: 6.37 | Loss: 0.0000
2025-03-02 15:25:28,905 - train - INFO - Evaluation at episode 500: -3.00 reward, Win rate: 0.27
2025-03-02 15:25:30,064 - train - INFO - Episode 600/5000 | Reward: -1.82 | Length: 6.80 | Loss: 0.0000
2025-03-02 15:25:31,289 - train - INFO - Evaluation at episode 600: -3.00 reward, Win rate: 0.17
2025-03-02 15:25:32,475 - train - INFO - Episode 700/5000 | Reward: -1.88 | Length: 6.57 | Loss: 0.0000
2025-03-02 15:25:33,871 - train - INFO - Evaluation at episode 700: -3.00 reward, Win rate: 0.17
2025-03-02 15:25:35,467 - train - INFO - Episode 800/5000 | Reward: -1.75 | Length: 6.76 | Loss: 0.0000
2025-03-02 15:25:36,753 - train - INFO - Evaluation at episode 800: -3.00 reward, Win rate: 0.13
2025-03-02 15:25:37,969 - train - INFO - Episode 900/5000 | Reward: -1.00 | Length: 7.14 | Loss: 0.0000
2025-03-02 15:25:39,361 - train - INFO - Evaluation at episode 900: -3.00 reward, Win rate: 0.17
2025-03-02 15:25:40,588 - train - INFO - Episode 1000/5000 | Reward: -1.69 | Length: 6.97 | Loss: 0.0000
2025-03-02 15:25:40,596 - train - INFO - Saved checkpoint to results/ppo_3dice\ppo_basic_2p3d_20250302_152449\checkpoints\level_1_naive\agent_episode_1000
2025-03-02 15:25:42,019 - train - INFO - Evaluation at episode 1000: -3.00 reward, Win rate: 0.17
2025-03-02 15:25:43,690 - train - INFO - Episode 1100/5000 | Reward: -0.66 | Length: 7.15 | Loss: 0.0000
2025-03-02 15:25:45,085 - train - INFO - Evaluation at episode 1100: -3.00 reward, Win rate: 0.37
2025-03-02 15:25:46,318 - train - INFO - Episode 1200/5000 | Reward: -0.70 | Length: 7.24 | Loss: 0.0000
2025-03-02 15:25:47,730 - train - INFO - Evaluation at episode 1200: 3.00 reward, Win rate: 0.33
2025-03-02 15:25:49,465 - train - INFO - Episode 1300/5000 | Reward: -0.60 | Length: 7.34 | Loss: 0.0000
2025-03-02 15:25:50,866 - train - INFO - Evaluation at episode 1300: -3.00 reward, Win rate: 0.43
2025-03-02 15:25:52,098 - train - INFO - Episode 1400/5000 | Reward: 0.08 | Length: 7.47 | Loss: 0.0000
2025-03-02 15:25:53,542 - train - INFO - Evaluation at episode 1400: -3.00 reward, Win rate: 0.40
2025-03-02 15:25:54,836 - train - INFO - Episode 1500/5000 | Reward: 0.07 | Length: 7.52 | Loss: 0.0000
2025-03-02 15:25:56,331 - train - INFO - Evaluation at episode 1500: 3.00 reward, Win rate: 0.57
2025-03-02 15:25:58,078 - train - INFO - Episode 1600/5000 | Reward: 0.20 | Length: 7.35 | Loss: 0.0000
2025-03-02 15:25:59,508 - train - INFO - Evaluation at episode 1600: 4.00 reward, Win rate: 0.73
2025-03-02 15:26:00,834 - train - INFO - Episode 1700/5000 | Reward: 1.05 | Length: 7.94 | Loss: 0.0000
2025-03-02 15:26:02,406 - train - INFO - Evaluation at episode 1700: 4.00 reward, Win rate: 0.63
2025-03-02 15:26:03,702 - train - INFO - Episode 1800/5000 | Reward: 0.25 | Length: 7.41 | Loss: 0.0000
2025-03-02 15:26:05,166 - train - INFO - Evaluation at episode 1800: 3.00 reward, Win rate: 0.67
2025-03-02 15:26:06,959 - train - INFO - Episode 1900/5000 | Reward: 1.29 | Length: 7.78 | Loss: 0.0000
2025-03-02 15:26:08,304 - train - INFO - Evaluation at episode 1900: -3.00 reward, Win rate: 0.60
2025-03-02 15:26:09,642 - train - INFO - Episode 2000/5000 | Reward: 1.59 | Length: 7.74 | Loss: 0.0000
2025-03-02 15:26:09,650 - train - INFO - Saved checkpoint to results/ppo_3dice\ppo_basic_2p3d_20250302_152449\checkpoints\level_1_naive\agent_episode_2000
2025-03-02 15:26:11,155 - train - INFO - Evaluation at episode 2000: 3.00 reward, Win rate: 0.77
2025-03-02 15:26:11,155 - train - INFO - Win rate 0.77 is above threshold 0.75 (1/3)
2025-03-02 15:26:12,474 - train - INFO - Episode 2100/5000 | Reward: 1.92 | Length: 7.78 | Loss: 0.0000
2025-03-02 15:26:13,996 - train - INFO - Evaluation at episode 2100: 3.00 reward, Win rate: 0.73
2025-03-02 15:26:15,649 - train - INFO - Episode 2200/5000 | Reward: 1.98 | Length: 7.26 | Loss: 0.0000
2025-03-02 15:26:17,054 - train - INFO - Evaluation at episode 2200: 5.00 reward, Win rate: 0.80
2025-03-02 15:26:17,054 - train - INFO - Win rate 0.80 is above threshold 0.75 (1/3)
2025-03-02 15:26:18,401 - train - INFO - Episode 2300/5000 | Reward: 2.37 | Length: 7.83 | Loss: 0.0000
2025-03-02 15:26:19,892 - train - INFO - Evaluation at episode 2300: 4.00 reward, Win rate: 0.67
2025-03-02 15:26:21,762 - train - INFO - Episode 2400/5000 | Reward: 2.63 | Length: 7.86 | Loss: 0.0000
2025-03-02 15:26:23,166 - train - INFO - Evaluation at episode 2400: 5.00 reward, Win rate: 0.97
2025-03-02 15:26:23,167 - train - INFO - Win rate 0.97 is above threshold 0.75 (1/3)
2025-03-02 15:26:24,381 - train - INFO - Episode 2500/5000 | Reward: 2.98 | Length: 7.61 | Loss: 0.0000
2025-03-02 15:26:25,855 - train - INFO - Evaluation at episode 2500: 3.00 reward, Win rate: 0.93
2025-03-02 15:26:25,855 - train - INFO - Win rate 0.93 is above threshold 0.75 (2/3)
2025-03-02 15:26:27,123 - train - INFO - Episode 2600/5000 | Reward: 3.27 | Length: 7.52 | Loss: 0.0000
2025-03-02 15:26:28,615 - train - INFO - Evaluation at episode 2600: 5.00 reward, Win rate: 0.87
2025-03-02 15:26:28,615 - train - INFO - Win rate 0.87 is above threshold 0.75 (3/3)
2025-03-02 15:26:28,615 - train - INFO - Early stopping triggered at episode 2600 with win rate 0.87
2025-03-02 15:26:28,623 - train - INFO - Training completed!
2025-03-02 15:26:30,888 - train - INFO - Final evaluation: 2.92 reward
