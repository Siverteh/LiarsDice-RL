2025-03-02 10:11:48,917 - curriculum - INFO - Starting curriculum learning for Liar's Dice with dqn agent
2025-03-02 10:11:48,917 - curriculum - INFO - Game setup: 2 players, 3 dice, 6 faces
2025-03-02 10:11:48,918 - curriculum - INFO - Curriculum: 30000 episodes, Self-play: 10000 episodes
2025-03-02 10:11:48,928 - curriculum - INFO - Using device: cuda
2025-03-02 10:11:48,929 - curriculum - INFO - Observation dimension: 35, Action dimension: 37
2025-03-02 10:11:49,423 - curriculum - INFO - Created dqn agent with 37 actions
2025-03-02 10:11:49,424 - curriculum - INFO - Curriculum schedule:
2025-03-02 10:11:49,425 - curriculum - INFO -   random: 1500 episodes (5.0%)
2025-03-02 10:11:49,425 - curriculum - INFO -   naive: 1500 episodes (5.0%)
2025-03-02 10:11:49,425 - curriculum - INFO -   conservative: 7500 episodes (25.0%)
2025-03-02 10:11:49,425 - curriculum - INFO -   aggressive: 3000 episodes (10.0%)
2025-03-02 10:11:49,425 - curriculum - INFO -   strategic: 10500 episodes (35.0%)
2025-03-02 10:11:49,425 - curriculum - INFO -   adaptive: 7500 episodes (25.0%)
2025-03-02 10:11:49,425 - curriculum - INFO - 
=== Training against random (1500 episodes) ===
2025-03-02 10:11:49,425 - curriculum - INFO - Setting epsilon to 0.90 for level random
2025-03-02 10:11:52,708 - curriculum - INFO - New best model for random: 0.97 win rate
2025-03-02 10:11:52,714 - curriculum - INFO - New best overall model: 0.97 win rate
2025-03-02 10:11:52,715 - curriculum - INFO - Win rate 0.97 above threshold 0.75 (1/3)
2025-03-02 10:11:55,927 - curriculum - INFO - Win rate 0.97 above threshold 0.75 (2/3)
2025-03-02 10:11:59,766 - curriculum - INFO - Loading best model for random (win rate: 0.97)
2025-03-02 10:11:59,814 - curriculum - INFO - Completed training against random
2025-03-02 10:11:59,815 - curriculum - INFO - Episodes: 1500, Duration: 10.34 seconds
2025-03-02 10:11:59,815 - curriculum - INFO - Final evaluation reward: 4.53
2025-03-02 10:11:59,815 - curriculum - INFO - Best win rate: 0.97
2025-03-02 10:11:59,815 - curriculum - INFO - 
=== Training against naive (1500 episodes) ===
2025-03-02 10:11:59,815 - curriculum - INFO - Setting epsilon to 0.70 for level naive
2025-03-02 10:12:02,992 - curriculum - INFO - New best model for naive: 1.00 win rate
2025-03-02 10:12:02,998 - curriculum - INFO - New best overall model: 1.00 win rate
2025-03-02 10:12:02,998 - curriculum - INFO - Win rate 1.00 above threshold 0.75 (1/3)
2025-03-02 10:12:06,266 - curriculum - INFO - Win rate 1.00 above threshold 0.75 (2/3)
2025-03-02 10:12:10,457 - curriculum - INFO - Loading best model for naive (win rate: 1.00)
2025-03-02 10:12:10,468 - curriculum - INFO - Completed training against naive
2025-03-02 10:12:10,469 - curriculum - INFO - Episodes: 1500, Duration: 10.64 seconds
2025-03-02 10:12:10,469 - curriculum - INFO - Final evaluation reward: 4.43
2025-03-02 10:12:10,469 - curriculum - INFO - Best win rate: 1.00
2025-03-02 10:12:10,469 - curriculum - INFO - Evaluating against all previous levels...
2025-03-02 10:12:10,718 - curriculum - INFO -   vs random: win rate = 1.00
2025-03-02 10:12:11,047 - curriculum - INFO -   vs naive: win rate = 0.93
2025-03-02 10:12:11,047 - curriculum - INFO -   Average win rate across all levels: 0.97
2025-03-02 10:12:11,047 - curriculum - INFO - 
=== Training against conservative (7500 episodes) ===
2025-03-02 10:12:11,048 - curriculum - INFO - Setting epsilon to 0.50 for level conservative
2025-03-02 10:12:13,586 - curriculum - INFO - New best model for conservative: 0.13 win rate
2025-03-02 10:12:23,497 - curriculum - INFO - New best model for conservative: 0.17 win rate
2025-03-02 10:12:47,110 - curriculum - INFO - New best model for conservative: 0.20 win rate
2025-03-02 10:14:06,768 - curriculum - INFO - New best model for conservative: 0.27 win rate
2025-03-02 10:16:03,642 - curriculum - INFO - Completed training against conservative
2025-03-02 10:16:03,642 - curriculum - INFO - Episodes: 7500, Duration: 232.59 seconds
2025-03-02 10:16:03,642 - curriculum - INFO - Final evaluation reward: -2.62
2025-03-02 10:16:03,642 - curriculum - INFO - Best win rate: 0.27
2025-03-02 10:16:03,642 - curriculum - INFO - Evaluating against all previous levels...
2025-03-02 10:16:03,951 - curriculum - INFO -   vs random: win rate = 0.87
2025-03-02 10:16:04,315 - curriculum - INFO -   vs naive: win rate = 0.37
2025-03-02 10:16:04,618 - curriculum - INFO -   vs conservative: win rate = 0.03
2025-03-02 10:16:04,618 - curriculum - INFO -   Average win rate across all levels: 0.42
2025-03-02 10:16:04,618 - curriculum - INFO - 
=== Training against aggressive (3000 episodes) ===
2025-03-02 10:16:04,618 - curriculum - INFO - Setting epsilon to 0.30 for level aggressive
2025-03-02 10:16:04,619 - curriculum - INFO - Adjusted learning rate to 0.000350 for level aggressive
2025-03-02 10:16:07,799 - curriculum - INFO - New best model for aggressive: 0.53 win rate
2025-03-02 10:16:24,750 - curriculum - INFO - New best model for aggressive: 0.67 win rate
2025-03-02 10:16:28,828 - curriculum - INFO - New best model for aggressive: 0.70 win rate
2025-03-02 10:16:32,919 - curriculum - INFO - New best model for aggressive: 0.73 win rate
2025-03-02 10:16:36,868 - curriculum - INFO - New best model for aggressive: 0.83 win rate
2025-03-02 10:16:36,868 - curriculum - INFO - Win rate 0.83 above threshold 0.75 (1/3)
2025-03-02 10:16:44,605 - curriculum - INFO - Win rate 0.83 above threshold 0.75 (1/3)
2025-03-02 10:16:48,409 - curriculum - INFO - Win rate 0.77 above threshold 0.75 (2/3)
2025-03-02 10:16:53,083 - curriculum - INFO - Loading best model for aggressive (win rate: 0.83)
2025-03-02 10:16:53,127 - curriculum - INFO - Completed training against aggressive
2025-03-02 10:16:53,127 - curriculum - INFO - Episodes: 3000, Duration: 48.46 seconds
2025-03-02 10:16:53,128 - curriculum - INFO - Final evaluation reward: 2.60
2025-03-02 10:16:53,128 - curriculum - INFO - Best win rate: 0.83
2025-03-02 10:16:53,128 - curriculum - INFO - Evaluating against all previous levels...
2025-03-02 10:16:53,435 - curriculum - INFO -   vs random: win rate = 0.87
2025-03-02 10:16:53,799 - curriculum - INFO -   vs naive: win rate = 0.57
2025-03-02 10:16:54,068 - curriculum - INFO -   vs conservative: win rate = 0.03
2025-03-02 10:16:54,399 - curriculum - INFO -   vs aggressive: win rate = 0.63
2025-03-02 10:16:54,399 - curriculum - INFO -   Average win rate across all levels: 0.53
2025-03-02 10:16:54,399 - curriculum - INFO - 
=== Training against strategic (10500 episodes) ===
2025-03-02 10:16:54,399 - curriculum - INFO - Setting epsilon to 0.10 for level strategic
2025-03-02 10:16:54,400 - curriculum - INFO - Adjusted learning rate to 0.000245 for level strategic
2025-03-02 10:16:58,320 - curriculum - INFO - New best model for strategic: 0.33 win rate
2025-03-02 10:17:14,006 - curriculum - INFO - New best model for strategic: 0.53 win rate
2025-03-02 10:17:35,056 - curriculum - INFO - New best model for strategic: 0.63 win rate
2025-03-02 10:17:39,760 - curriculum - INFO - New best model for strategic: 0.73 win rate
2025-03-02 10:17:44,473 - curriculum - INFO - New best model for strategic: 0.80 win rate
2025-03-02 10:17:44,473 - curriculum - INFO - Win rate 0.80 above threshold 0.75 (1/3)
2025-03-02 10:17:49,054 - curriculum - INFO - New best model for strategic: 0.87 win rate
2025-03-02 10:17:49,054 - curriculum - INFO - Win rate 0.87 above threshold 0.75 (2/3)
2025-03-02 10:18:03,467 - curriculum - INFO - Win rate 0.83 above threshold 0.75 (1/3)
2025-03-02 10:18:13,239 - curriculum - INFO - New best model for strategic: 0.93 win rate
2025-03-02 10:18:13,239 - curriculum - INFO - Win rate 0.93 above threshold 0.75 (1/3)
2025-03-02 10:18:18,045 - curriculum - INFO - Win rate 0.80 above threshold 0.75 (2/3)
2025-03-02 10:18:23,773 - curriculum - INFO - Loading best model for strategic (win rate: 0.93)
2025-03-02 10:18:23,825 - curriculum - INFO - Completed training against strategic
2025-03-02 10:18:23,825 - curriculum - INFO - Episodes: 10500, Duration: 89.37 seconds
2025-03-02 10:18:23,825 - curriculum - INFO - Final evaluation reward: 2.33
2025-03-02 10:18:23,826 - curriculum - INFO - Best win rate: 0.93
2025-03-02 10:18:23,826 - curriculum - INFO - Evaluating against all previous levels...
2025-03-02 10:18:24,110 - curriculum - INFO -   vs random: win rate = 0.93
2025-03-02 10:18:24,470 - curriculum - INFO -   vs naive: win rate = 1.00
2025-03-02 10:18:24,830 - curriculum - INFO -   vs conservative: win rate = 0.50
2025-03-02 10:18:25,118 - curriculum - INFO -   vs aggressive: win rate = 1.00
2025-03-02 10:18:25,514 - curriculum - INFO -   vs strategic: win rate = 0.97
2025-03-02 10:18:25,514 - curriculum - INFO -   Average win rate across all levels: 0.88
2025-03-02 10:18:25,514 - curriculum - INFO - 
=== Training against adaptive (7500 episodes) ===
2025-03-02 10:18:25,514 - curriculum - INFO - Setting epsilon to 0.05 for level adaptive
2025-03-02 10:18:25,515 - curriculum - INFO - Adjusted learning rate to 0.000171 for level adaptive
2025-03-02 10:18:30,362 - curriculum - INFO - New best model for adaptive: 0.83 win rate
2025-03-02 10:18:30,362 - curriculum - INFO - Win rate 0.83 above threshold 0.75 (1/3)
2025-03-02 10:18:35,099 - curriculum - INFO - New best model for adaptive: 0.87 win rate
2025-03-02 10:18:35,099 - curriculum - INFO - Win rate 0.87 above threshold 0.75 (2/3)
2025-03-02 10:18:40,945 - curriculum - INFO - Loading best model for adaptive (win rate: 0.87)
2025-03-02 10:18:40,994 - curriculum - INFO - Completed training against adaptive
2025-03-02 10:18:40,994 - curriculum - INFO - Episodes: 7500, Duration: 15.43 seconds
2025-03-02 10:18:40,994 - curriculum - INFO - Final evaluation reward: 3.01
2025-03-02 10:18:40,994 - curriculum - INFO - Best win rate: 0.87
2025-03-02 10:18:40,994 - curriculum - INFO - Evaluating against all previous levels...
2025-03-02 10:18:41,283 - curriculum - INFO -   vs random: win rate = 0.97
2025-03-02 10:18:41,646 - curriculum - INFO -   vs naive: win rate = 0.97
2025-03-02 10:18:42,023 - curriculum - INFO -   vs conservative: win rate = 0.47
2025-03-02 10:18:42,309 - curriculum - INFO -   vs aggressive: win rate = 1.00
2025-03-02 10:18:42,681 - curriculum - INFO -   vs strategic: win rate = 0.70
2025-03-02 10:18:43,049 - curriculum - INFO -   vs adaptive: win rate = 0.57
2025-03-02 10:18:43,049 - curriculum - INFO -   Average win rate across all levels: 0.78
2025-03-02 10:18:43,050 - curriculum - INFO - 
=== Final Evaluation ===
2025-03-02 10:18:49,070 - curriculum - INFO - Saved final evaluation visualization to results/dqn_3dice\dqn_basic_2p3d_20250302_101148\logs\final_evaluation.png
2025-03-02 10:18:49,092 - curriculum - INFO - Saved final model to results/dqn_3dice\models\dqn_2p3d_0.80wr_20250302_101148
2025-03-02 10:18:49,092 - curriculum - INFO - 
Curriculum learning completed!
