2025-03-02 16:01:05,820 - train - INFO - Starting training for 10000 episodes with agent type: PPOAgent
2025-03-02 16:01:05,820 - train - INFO - Agent config: {'obs_dim': 35, 'action_dim': 37, 'hidden_dims': [256, 128, 64], 'learning_rate': 0.0003, 'min_learning_rate': 3e-05, 'gamma': 0.99, 'gae_lambda': 0.95, 'policy_clip': 0.2, 'value_coef': 0.5, 'entropy_coef': 0.0038771650526258873, 'batch_size': 64, 'update_frequency': 2048, 'max_grad_norm': 0.5, 'update_counter': 56, 'step_counter': 1834, 'total_training_steps': 1000000, 'current_lr': 0.000484893452474516, 'device': 'cuda', 'memory_size': 0, 'avg_policy_loss': 0.0, 'avg_value_loss': 0.0, 'avg_entropy': 0.0, 'avg_reward': 0.0}
2025-03-02 16:01:07,639 - train - INFO - Episode 100/10000 | Reward: 1.02 | Length: 5.50 | Loss: 0.0000
2025-03-02 16:01:15,638 - train - INFO - Evaluation at episode 100: 4.00 reward, Win rate: 0.53
2025-03-02 16:01:17,425 - train - INFO - Episode 200/10000 | Reward: 0.89 | Length: 5.82 | Loss: 0.0000
2025-03-02 16:01:26,335 - train - INFO - Evaluation at episode 200: 5.00 reward, Win rate: 0.53
2025-03-02 16:01:28,171 - train - INFO - Episode 300/10000 | Reward: 1.22 | Length: 5.49 | Loss: 0.0000
2025-03-02 16:01:36,932 - train - INFO - Evaluation at episode 300: 4.00 reward, Win rate: 0.53
2025-03-02 16:01:38,848 - train - INFO - Episode 400/10000 | Reward: 1.38 | Length: 5.72 | Loss: 0.0000
2025-03-02 16:01:47,502 - train - INFO - Evaluation at episode 400: 5.00 reward, Win rate: 0.57
2025-03-02 16:01:49,820 - train - INFO - Episode 500/10000 | Reward: 0.19 | Length: 5.71 | Loss: 0.0000
2025-03-02 16:01:49,826 - train - INFO - Saved checkpoint to results/self_play\self_play_ppo_2p3d_20250302_160105\checkpoints\round_1\agent_episode_500
2025-03-02 16:01:58,372 - train - INFO - Evaluation at episode 500: -3.00 reward, Win rate: 0.50
2025-03-02 16:02:00,307 - train - INFO - Episode 600/10000 | Reward: 1.31 | Length: 5.76 | Loss: 0.0000
2025-03-02 16:02:08,839 - train - INFO - Evaluation at episode 600: 5.00 reward, Win rate: 0.50
2025-03-02 16:02:10,762 - train - INFO - Episode 700/10000 | Reward: 1.25 | Length: 5.76 | Loss: 0.0000
2025-03-02 16:02:19,447 - train - INFO - Evaluation at episode 700: -3.00 reward, Win rate: 0.57
2025-03-02 16:02:21,778 - train - INFO - Episode 800/10000 | Reward: 1.31 | Length: 5.58 | Loss: 0.0000
2025-03-02 16:02:30,306 - train - INFO - Evaluation at episode 800: -3.00 reward, Win rate: 0.53
2025-03-02 16:02:32,168 - train - INFO - Episode 900/10000 | Reward: 0.99 | Length: 5.46 | Loss: 0.0000
2025-03-02 16:02:40,817 - train - INFO - Evaluation at episode 900: 4.00 reward, Win rate: 0.67
2025-03-02 16:02:42,779 - train - INFO - Episode 1000/10000 | Reward: 0.84 | Length: 5.91 | Loss: 0.0000
2025-03-02 16:02:42,787 - train - INFO - Saved checkpoint to results/self_play\self_play_ppo_2p3d_20250302_160105\checkpoints\round_1\agent_episode_1000
2025-03-02 16:02:51,296 - train - INFO - Evaluation at episode 1000: 3.00 reward, Win rate: 0.63
2025-03-02 16:02:53,226 - train - INFO - Episode 1100/10000 | Reward: 1.27 | Length: 5.62 | Loss: 0.0000
2025-03-02 16:03:01,855 - train - INFO - Evaluation at episode 1100: 5.00 reward, Win rate: 0.60
2025-03-02 16:03:04,154 - train - INFO - Episode 1200/10000 | Reward: 1.89 | Length: 5.58 | Loss: 0.0000
2025-03-02 16:03:12,715 - train - INFO - Evaluation at episode 1200: -3.00 reward, Win rate: 0.70
2025-03-02 16:03:14,619 - train - INFO - Episode 1300/10000 | Reward: 1.30 | Length: 5.73 | Loss: 0.0000
2025-03-02 16:03:23,267 - train - INFO - Evaluation at episode 1300: 4.00 reward, Win rate: 0.63
2025-03-02 16:03:25,105 - train - INFO - Episode 1400/10000 | Reward: 1.48 | Length: 5.68 | Loss: 0.0000
2025-03-02 16:03:33,822 - train - INFO - Evaluation at episode 1400: 4.00 reward, Win rate: 0.53
2025-03-02 16:03:35,670 - train - INFO - Episode 1500/10000 | Reward: 1.16 | Length: 5.37 | Loss: 0.0000
2025-03-02 16:03:35,678 - train - INFO - Saved checkpoint to results/self_play\self_play_ppo_2p3d_20250302_160105\checkpoints\round_1\agent_episode_1500
2025-03-02 16:03:44,311 - train - INFO - Evaluation at episode 1500: -3.00 reward, Win rate: 0.67
2025-03-02 16:03:46,550 - train - INFO - Episode 1600/10000 | Reward: 1.81 | Length: 5.51 | Loss: 0.0000
2025-03-02 16:03:55,031 - train - INFO - Evaluation at episode 1600: 5.00 reward, Win rate: 0.70
2025-03-02 16:03:56,962 - train - INFO - Episode 1700/10000 | Reward: 1.96 | Length: 5.84 | Loss: 0.0000
2025-03-02 16:04:05,621 - train - INFO - Evaluation at episode 1700: 4.00 reward, Win rate: 0.73
2025-03-02 16:04:07,535 - train - INFO - Episode 1800/10000 | Reward: 1.38 | Length: 5.68 | Loss: 0.0000
2025-03-02 16:04:16,040 - train - INFO - Evaluation at episode 1800: 4.00 reward, Win rate: 0.50
2025-03-02 16:04:18,406 - train - INFO - Episode 1900/10000 | Reward: 1.60 | Length: 5.74 | Loss: 0.0000
2025-03-02 16:04:26,892 - train - INFO - Evaluation at episode 1900: -3.00 reward, Win rate: 0.77
2025-03-02 16:04:28,807 - train - INFO - Episode 2000/10000 | Reward: 2.09 | Length: 5.84 | Loss: 0.0000
2025-03-02 16:04:28,816 - train - INFO - Saved checkpoint to results/self_play\self_play_ppo_2p3d_20250302_160105\checkpoints\round_1\agent_episode_2000
2025-03-02 16:04:37,352 - train - INFO - Evaluation at episode 2000: 5.00 reward, Win rate: 0.80
2025-03-02 16:04:39,207 - train - INFO - Episode 2100/10000 | Reward: 2.22 | Length: 5.68 | Loss: 0.0000
2025-03-02 16:04:47,687 - train - INFO - Evaluation at episode 2100: 4.00 reward, Win rate: 0.60
2025-03-02 16:04:49,543 - train - INFO - Episode 2200/10000 | Reward: 1.69 | Length: 5.63 | Loss: 0.0000
2025-03-02 16:04:58,112 - train - INFO - Evaluation at episode 2200: -3.00 reward, Win rate: 0.57
2025-03-02 16:05:00,372 - train - INFO - Episode 2300/10000 | Reward: 1.61 | Length: 5.33 | Loss: 0.0000
2025-03-02 16:05:08,758 - train - INFO - Evaluation at episode 2300: 4.00 reward, Win rate: 0.77
2025-03-02 16:05:10,604 - train - INFO - Episode 2400/10000 | Reward: 1.47 | Length: 5.67 | Loss: 0.0000
2025-03-02 16:05:19,008 - train - INFO - Evaluation at episode 2400: -3.00 reward, Win rate: 0.50
2025-03-02 16:05:20,792 - train - INFO - Episode 2500/10000 | Reward: 1.91 | Length: 5.32 | Loss: 0.0000
2025-03-02 16:05:20,800 - train - INFO - Saved checkpoint to results/self_play\self_play_ppo_2p3d_20250302_160105\checkpoints\round_1\agent_episode_2500
2025-03-02 16:05:29,133 - train - INFO - Evaluation at episode 2500: 5.00 reward, Win rate: 0.63
2025-03-02 16:05:30,963 - train - INFO - Episode 2600/10000 | Reward: 1.61 | Length: 5.57 | Loss: 0.0000
2025-03-02 16:05:39,366 - train - INFO - Evaluation at episode 2600: -3.00 reward, Win rate: 0.83
2025-03-02 16:05:41,630 - train - INFO - Episode 2700/10000 | Reward: 2.03 | Length: 5.35 | Loss: 0.0000
2025-03-02 16:05:50,055 - train - INFO - Evaluation at episode 2700: 3.00 reward, Win rate: 0.67
2025-03-02 16:05:51,855 - train - INFO - Episode 2800/10000 | Reward: 1.37 | Length: 5.57 | Loss: 0.0000
2025-03-02 16:06:00,212 - train - INFO - Evaluation at episode 2800: 5.00 reward, Win rate: 0.63
2025-03-02 16:06:02,039 - train - INFO - Episode 2900/10000 | Reward: 2.12 | Length: 5.53 | Loss: 0.0000
2025-03-02 16:06:10,402 - train - INFO - Evaluation at episode 2900: -3.00 reward, Win rate: 0.73
2025-03-02 16:06:12,732 - train - INFO - Episode 3000/10000 | Reward: 2.13 | Length: 5.76 | Loss: 0.0000
2025-03-02 16:06:12,739 - train - INFO - Saved checkpoint to results/self_play\self_play_ppo_2p3d_20250302_160105\checkpoints\round_1\agent_episode_3000
2025-03-02 16:06:21,083 - train - INFO - Evaluation at episode 3000: 5.00 reward, Win rate: 0.67
2025-03-02 16:06:22,880 - train - INFO - Episode 3100/10000 | Reward: 1.74 | Length: 5.53 | Loss: 0.0000
2025-03-02 16:06:31,282 - train - INFO - Evaluation at episode 3100: -3.00 reward, Win rate: 0.70
2025-03-02 16:06:33,181 - train - INFO - Episode 3200/10000 | Reward: 1.79 | Length: 5.56 | Loss: 0.0000
2025-03-02 16:06:41,541 - train - INFO - Evaluation at episode 3200: -3.00 reward, Win rate: 0.67
2025-03-02 16:06:43,352 - train - INFO - Episode 3300/10000 | Reward: 1.23 | Length: 5.55 | Loss: 0.0000
2025-03-02 16:06:51,709 - train - INFO - Evaluation at episode 3300: -3.00 reward, Win rate: 0.70
2025-03-02 16:06:54,002 - train - INFO - Episode 3400/10000 | Reward: 2.48 | Length: 5.39 | Loss: 0.0000
2025-03-02 16:07:02,252 - train - INFO - Evaluation at episode 3400: 4.00 reward, Win rate: 0.63
2025-03-02 16:07:04,109 - train - INFO - Episode 3500/10000 | Reward: 1.90 | Length: 5.46 | Loss: 0.0000
2025-03-02 16:07:04,115 - train - INFO - Saved checkpoint to results/self_play\self_play_ppo_2p3d_20250302_160105\checkpoints\round_1\agent_episode_3500
2025-03-02 16:07:12,613 - train - INFO - Evaluation at episode 3500: 5.00 reward, Win rate: 0.73
2025-03-02 16:07:14,437 - train - INFO - Episode 3600/10000 | Reward: 1.92 | Length: 5.56 | Loss: 0.0000
2025-03-02 16:07:22,714 - train - INFO - Evaluation at episode 3600: 3.00 reward, Win rate: 0.77
2025-03-02 16:07:24,515 - train - INFO - Episode 3700/10000 | Reward: 2.55 | Length: 5.48 | Loss: 0.0000
2025-03-02 16:07:32,897 - train - INFO - Evaluation at episode 3700: -3.00 reward, Win rate: 0.50
2025-03-02 16:07:35,105 - train - INFO - Episode 3800/10000 | Reward: 1.43 | Length: 5.40 | Loss: 0.0000
2025-03-02 16:07:43,349 - train - INFO - Evaluation at episode 3800: 3.00 reward, Win rate: 0.87
2025-03-02 16:07:45,197 - train - INFO - Episode 3900/10000 | Reward: 2.19 | Length: 5.61 | Loss: 0.0000
2025-03-02 16:07:53,729 - train - INFO - Evaluation at episode 3900: 5.00 reward, Win rate: 0.63
2025-03-02 16:07:55,530 - train - INFO - Episode 4000/10000 | Reward: 1.60 | Length: 5.42 | Loss: 0.0000
2025-03-02 16:07:55,538 - train - INFO - Saved checkpoint to results/self_play\self_play_ppo_2p3d_20250302_160105\checkpoints\round_1\agent_episode_4000
2025-03-02 16:08:04,081 - train - INFO - Evaluation at episode 4000: 4.00 reward, Win rate: 0.63
2025-03-02 16:08:05,974 - train - INFO - Episode 4100/10000 | Reward: 2.07 | Length: 5.60 | Loss: 0.0000
2025-03-02 16:08:14,678 - train - INFO - Evaluation at episode 4100: 3.00 reward, Win rate: 0.60
2025-03-02 16:08:17,035 - train - INFO - Episode 4200/10000 | Reward: 1.92 | Length: 5.84 | Loss: 0.0000
2025-03-02 16:08:25,596 - train - INFO - Evaluation at episode 4200: 4.00 reward, Win rate: 0.73
2025-03-02 16:08:27,498 - train - INFO - Episode 4300/10000 | Reward: 2.25 | Length: 5.78 | Loss: 0.0000
2025-03-02 16:08:36,153 - train - INFO - Evaluation at episode 4300: 5.00 reward, Win rate: 0.73
2025-03-02 16:08:37,980 - train - INFO - Episode 4400/10000 | Reward: 1.79 | Length: 5.56 | Loss: 0.0000
2025-03-02 16:08:46,480 - train - INFO - Evaluation at episode 4400: 3.00 reward, Win rate: 0.63
2025-03-02 16:08:48,801 - train - INFO - Episode 4500/10000 | Reward: 2.32 | Length: 5.73 | Loss: 0.0000
2025-03-02 16:08:48,809 - train - INFO - Saved checkpoint to results/self_play\self_play_ppo_2p3d_20250302_160105\checkpoints\round_1\agent_episode_4500
2025-03-02 16:08:57,283 - train - INFO - Evaluation at episode 4500: 4.00 reward, Win rate: 0.87
2025-03-02 16:08:59,148 - train - INFO - Episode 4600/10000 | Reward: 2.43 | Length: 5.44 | Loss: 0.0000
2025-03-02 16:09:07,822 - train - INFO - Evaluation at episode 4600: -3.00 reward, Win rate: 0.70
2025-03-02 16:09:09,781 - train - INFO - Episode 4700/10000 | Reward: 1.91 | Length: 5.67 | Loss: 0.0000
2025-03-02 16:09:18,845 - train - INFO - Evaluation at episode 4700: -3.00 reward, Win rate: 0.73
2025-03-02 16:09:20,505 - train - INFO - Episode 4800/10000 | Reward: 2.37 | Length: 5.32 | Loss: 0.0000
2025-03-02 16:09:29,397 - train - INFO - Evaluation at episode 4800: 4.00 reward, Win rate: 0.83
2025-03-02 16:09:31,686 - train - INFO - Episode 4900/10000 | Reward: 2.18 | Length: 5.75 | Loss: 0.0000
2025-03-02 16:09:40,376 - train - INFO - Evaluation at episode 4900: 4.00 reward, Win rate: 0.77
2025-03-02 16:09:41,889 - train - INFO - Episode 5000/10000 | Reward: 2.48 | Length: 5.47 | Loss: 0.0000
2025-03-02 16:09:41,897 - train - INFO - Saved checkpoint to results/self_play\self_play_ppo_2p3d_20250302_160105\checkpoints\round_1\agent_episode_5000
2025-03-02 16:09:49,484 - train - INFO - Evaluation at episode 5000: 3.00 reward, Win rate: 0.77
2025-03-02 16:09:51,004 - train - INFO - Episode 5100/10000 | Reward: 2.47 | Length: 5.42 | Loss: 0.0000
2025-03-02 16:09:59,341 - train - INFO - Evaluation at episode 5100: 5.00 reward, Win rate: 0.73
2025-03-02 16:10:01,015 - train - INFO - Episode 5200/10000 | Reward: 2.11 | Length: 5.48 | Loss: 0.0000
2025-03-02 16:10:09,719 - train - INFO - Evaluation at episode 5200: 5.00 reward, Win rate: 0.80
2025-03-02 16:10:11,797 - train - INFO - Episode 5300/10000 | Reward: 2.84 | Length: 5.55 | Loss: 0.0000
2025-03-02 16:10:20,371 - train - INFO - Evaluation at episode 5300: 4.00 reward, Win rate: 0.90
2025-03-02 16:10:20,387 - train - INFO - Training stopped early by callback at episode 5300
2025-03-02 16:10:20,387 - train - INFO - Training completed!
2025-03-02 16:10:36,716 - train - INFO - Final evaluation: 2.60 reward
