2025-03-02 16:01:05,290 - self_play - INFO - Starting self-play learning for Liar's Dice with loaded ppo agent
2025-03-02 16:01:05,290 - self_play - INFO - Game setup: 2 players, 3 dice, 6 faces
2025-03-02 16:01:05,290 - self_play - INFO - Self-play: 5 rounds with 10000 episodes per round
2025-03-02 16:01:05,301 - self_play - INFO - Using device: cuda
2025-03-02 16:01:05,301 - self_play - INFO - Observation dimension: 35, Action dimension: 37
2025-03-02 16:01:05,791 - self_play - INFO - Loading pre-trained model from results\ppo_3dice\models\ppo_2p3d_0.85wr_20250302_152449
2025-03-02 16:01:05,819 - self_play - INFO - 
=== Starting Self-Play Round 1/5 ===
2025-03-02 16:01:15,644 - self_play - INFO - New best model for round 1: 0.533 win rate
2025-03-02 16:01:15,651 - self_play - INFO - New best overall model: 0.533 win rate
2025-03-02 16:01:47,508 - self_play - INFO - New best model for round 1: 0.567 win rate
2025-03-02 16:01:47,514 - self_play - INFO - New best overall model: 0.567 win rate
2025-03-02 16:02:40,824 - self_play - INFO - New best model for round 1: 0.667 win rate
2025-03-02 16:02:40,831 - self_play - INFO - New best overall model: 0.667 win rate
2025-03-02 16:03:12,722 - self_play - INFO - New best model for round 1: 0.700 win rate
2025-03-02 16:03:12,728 - self_play - INFO - New best overall model: 0.700 win rate
2025-03-02 16:04:05,628 - self_play - INFO - New best model for round 1: 0.733 win rate
2025-03-02 16:04:05,635 - self_play - INFO - New best overall model: 0.733 win rate
2025-03-02 16:04:26,899 - self_play - INFO - New best model for round 1: 0.767 win rate
2025-03-02 16:04:26,906 - self_play - INFO - New best overall model: 0.767 win rate
2025-03-02 16:04:37,359 - self_play - INFO - New best model for round 1: 0.800 win rate
2025-03-02 16:04:37,364 - self_play - INFO - New best overall model: 0.800 win rate
2025-03-02 16:05:39,373 - self_play - INFO - New best model for round 1: 0.833 win rate
2025-03-02 16:05:39,381 - self_play - INFO - New best overall model: 0.833 win rate
2025-03-02 16:07:43,355 - self_play - INFO - New best model for round 1: 0.867 win rate
2025-03-02 16:07:43,361 - self_play - INFO - New best overall model: 0.867 win rate
2025-03-02 16:10:20,381 - self_play - INFO - New best model for round 1: 0.900 win rate
2025-03-02 16:10:20,387 - self_play - INFO - New best overall model: 0.900 win rate
2025-03-02 16:10:20,387 - self_play - INFO - Win rate threshold 0.900 reached with 0.900
2025-03-02 16:10:36,716 - self_play - INFO - Completed self-play round 1
2025-03-02 16:10:36,717 - self_play - INFO - Duration: 570.90 seconds
2025-03-02 16:10:36,717 - self_play - INFO - Best win rate: 0.900
2025-03-02 16:10:36,717 - self_play - INFO - Updating opponent with best model from round 1
2025-03-02 16:10:36,756 - self_play - INFO - Evaluating against rule-based agents...
2025-03-02 16:11:17,577 - self_play - INFO - Evaluation results vs rule-based agents:
2025-03-02 16:11:17,577 - self_play - INFO -   vs random: win rate = 0.987
2025-03-02 16:11:17,577 - self_play - INFO -   vs naive: win rate = 0.910
2025-03-02 16:11:17,578 - self_play - INFO -   vs conservative: win rate = 0.583
2025-03-02 16:11:17,578 - self_play - INFO -   vs anti_exploitation: win rate = 0.770
2025-03-02 16:11:17,578 - self_play - INFO -   vs aggressive: win rate = 1.000
2025-03-02 16:11:17,578 - self_play - INFO -   vs strategic: win rate = 0.640
2025-03-02 16:11:17,578 - self_play - INFO -   vs adaptive: win rate = 0.687
2025-03-02 16:11:17,578 - self_play - INFO -   vs counter_strategy: win rate = 0.770
2025-03-02 16:11:17,578 - self_play - INFO -   vs optimal: win rate = 0.877
2025-03-02 16:11:17,578 - self_play - INFO -   Overall win rate: 0.803
2025-03-02 16:11:17,766 - self_play - INFO - 
=== Starting Self-Play Round 2/5 ===
2025-03-02 16:11:27,423 - self_play - INFO - New best model for round 2: 0.767 win rate
2025-03-02 16:12:55,195 - self_play - INFO - New best model for round 2: 0.800 win rate
2025-03-02 16:13:34,282 - self_play - INFO - New best model for round 2: 0.867 win rate
2025-03-02 16:14:14,471 - self_play - INFO - New best model for round 2: 0.933 win rate
2025-03-02 16:14:14,477 - self_play - INFO - New best overall model: 0.933 win rate
2025-03-02 16:14:14,477 - self_play - INFO - Win rate threshold 0.900 reached with 0.933
2025-03-02 16:14:29,993 - self_play - INFO - Completed self-play round 2
2025-03-02 16:14:29,993 - self_play - INFO - Duration: 192.23 seconds
2025-03-02 16:14:29,993 - self_play - INFO - Best win rate: 0.933
2025-03-02 16:14:29,993 - self_play - INFO - Updating opponent with best model from round 2
2025-03-02 16:14:30,032 - self_play - INFO - Evaluating against rule-based agents...
2025-03-02 16:15:13,177 - self_play - INFO - Evaluation results vs rule-based agents:
2025-03-02 16:15:13,177 - self_play - INFO -   vs random: win rate = 0.993
2025-03-02 16:15:13,177 - self_play - INFO -   vs naive: win rate = 0.873
2025-03-02 16:15:13,177 - self_play - INFO -   vs conservative: win rate = 0.530
2025-03-02 16:15:13,177 - self_play - INFO -   vs anti_exploitation: win rate = 0.797
2025-03-02 16:15:13,177 - self_play - INFO -   vs aggressive: win rate = 0.997
2025-03-02 16:15:13,177 - self_play - INFO -   vs strategic: win rate = 0.577
2025-03-02 16:15:13,177 - self_play - INFO -   vs adaptive: win rate = 0.590
2025-03-02 16:15:13,177 - self_play - INFO -   vs counter_strategy: win rate = 0.713
2025-03-02 16:15:13,177 - self_play - INFO -   vs optimal: win rate = 0.857
2025-03-02 16:15:13,177 - self_play - INFO -   Overall win rate: 0.770
2025-03-02 16:15:13,327 - self_play - INFO - 
=== Starting Self-Play Round 3/5 ===
2025-03-02 16:15:23,274 - self_play - INFO - New best model for round 3: 0.733 win rate
2025-03-02 16:15:53,461 - self_play - INFO - New best model for round 3: 0.800 win rate
2025-03-02 16:16:44,045 - self_play - INFO - New best model for round 3: 0.833 win rate
2025-03-02 16:21:21,964 - self_play - INFO - New best model for round 3: 0.867 win rate
2025-03-02 16:28:10,686 - self_play - INFO - New best model for round 3: 0.900 win rate
2025-03-02 16:28:10,687 - self_play - INFO - Win rate threshold 0.900 reached with 0.900
2025-03-02 16:28:26,555 - self_play - INFO - Completed self-play round 3
2025-03-02 16:28:26,556 - self_play - INFO - Duration: 793.23 seconds
2025-03-02 16:28:26,556 - self_play - INFO - Best win rate: 0.900
2025-03-02 16:28:26,556 - self_play - INFO - Updating opponent with best model from round 3
2025-03-02 16:28:26,606 - self_play - INFO - Evaluating against rule-based agents...
2025-03-02 16:29:11,026 - self_play - INFO - Evaluation results vs rule-based agents:
2025-03-02 16:29:11,026 - self_play - INFO -   vs random: win rate = 0.990
2025-03-02 16:29:11,026 - self_play - INFO -   vs naive: win rate = 0.830
2025-03-02 16:29:11,026 - self_play - INFO -   vs conservative: win rate = 0.407
2025-03-02 16:29:11,027 - self_play - INFO -   vs anti_exploitation: win rate = 0.733
2025-03-02 16:29:11,027 - self_play - INFO -   vs aggressive: win rate = 0.993
2025-03-02 16:29:11,027 - self_play - INFO -   vs strategic: win rate = 0.363
2025-03-02 16:29:11,027 - self_play - INFO -   vs adaptive: win rate = 0.467
2025-03-02 16:29:11,027 - self_play - INFO -   vs counter_strategy: win rate = 0.613
2025-03-02 16:29:11,027 - self_play - INFO -   vs optimal: win rate = 0.887
2025-03-02 16:29:11,027 - self_play - INFO -   Overall win rate: 0.698
2025-03-02 16:29:11,183 - self_play - INFO - 
=== Starting Self-Play Round 4/5 ===
2025-03-02 16:29:22,099 - self_play - INFO - New best model for round 4: 0.933 win rate
2025-03-02 16:29:22,099 - self_play - INFO - Win rate threshold 0.900 reached with 0.933
2025-03-02 16:29:39,584 - self_play - INFO - Completed self-play round 4
2025-03-02 16:29:39,584 - self_play - INFO - Duration: 28.40 seconds
2025-03-02 16:29:39,584 - self_play - INFO - Best win rate: 0.933
2025-03-02 16:29:39,584 - self_play - INFO - Updating opponent with best model from round 4
2025-03-02 16:29:39,632 - self_play - INFO - Evaluating against rule-based agents...
2025-03-02 16:30:25,191 - self_play - INFO - Evaluation results vs rule-based agents:
2025-03-02 16:30:25,191 - self_play - INFO -   vs random: win rate = 1.000
2025-03-02 16:30:25,191 - self_play - INFO -   vs naive: win rate = 0.827
2025-03-02 16:30:25,191 - self_play - INFO -   vs conservative: win rate = 0.363
2025-03-02 16:30:25,191 - self_play - INFO -   vs anti_exploitation: win rate = 0.720
2025-03-02 16:30:25,191 - self_play - INFO -   vs aggressive: win rate = 0.993
2025-03-02 16:30:25,192 - self_play - INFO -   vs strategic: win rate = 0.397
2025-03-02 16:30:25,192 - self_play - INFO -   vs adaptive: win rate = 0.507
2025-03-02 16:30:25,192 - self_play - INFO -   vs counter_strategy: win rate = 0.703
2025-03-02 16:30:25,192 - self_play - INFO -   vs optimal: win rate = 0.900
2025-03-02 16:30:25,192 - self_play - INFO -   Overall win rate: 0.712
2025-03-02 16:30:25,348 - self_play - INFO - 
=== Starting Self-Play Round 5/5 ===
2025-03-02 16:30:36,286 - self_play - INFO - New best model for round 5: 0.700 win rate
2025-03-02 16:30:47,860 - self_play - INFO - New best model for round 5: 0.733 win rate
2025-03-02 16:30:59,961 - self_play - INFO - New best model for round 5: 0.867 win rate
2025-03-02 16:35:20,531 - self_play - INFO - New best model for round 5: 0.933 win rate
2025-03-02 16:35:20,532 - self_play - INFO - Win rate threshold 0.900 reached with 0.933
2025-03-02 16:35:37,730 - self_play - INFO - Completed self-play round 5
2025-03-02 16:35:37,730 - self_play - INFO - Duration: 312.38 seconds
2025-03-02 16:35:37,730 - self_play - INFO - Best win rate: 0.933
2025-03-02 16:35:37,730 - self_play - INFO - Updating opponent with best model from round 5
2025-03-02 16:35:37,779 - self_play - INFO - Evaluating against rule-based agents...
2025-03-02 16:36:21,494 - self_play - INFO - Evaluation results vs rule-based agents:
2025-03-02 16:36:21,494 - self_play - INFO -   vs random: win rate = 0.993
2025-03-02 16:36:21,494 - self_play - INFO -   vs naive: win rate = 0.827
2025-03-02 16:36:21,494 - self_play - INFO -   vs conservative: win rate = 0.373
2025-03-02 16:36:21,494 - self_play - INFO -   vs anti_exploitation: win rate = 0.750
2025-03-02 16:36:21,494 - self_play - INFO -   vs aggressive: win rate = 0.997
2025-03-02 16:36:21,494 - self_play - INFO -   vs strategic: win rate = 0.310
2025-03-02 16:36:21,494 - self_play - INFO -   vs adaptive: win rate = 0.483
2025-03-02 16:36:21,494 - self_play - INFO -   vs counter_strategy: win rate = 0.653
2025-03-02 16:36:21,495 - self_play - INFO -   vs optimal: win rate = 0.913
2025-03-02 16:36:21,495 - self_play - INFO -   Overall win rate: 0.700
2025-03-02 16:36:21,650 - self_play - INFO - 
=== Final Evaluation ===
2025-03-02 16:37:54,615 - self_play - INFO - Saved final evaluation visualization to results/self_play\self_play_ppo_2p3d_20250302_160105\logs\final_evaluation.png
2025-03-02 16:37:54,629 - self_play - INFO - Saved final model to results/self_play\models\self_play_ppo_2p3d_0.71wr_20250302_160105
2025-03-02 16:37:54,629 - self_play - INFO - 
Self-play learning completed!
