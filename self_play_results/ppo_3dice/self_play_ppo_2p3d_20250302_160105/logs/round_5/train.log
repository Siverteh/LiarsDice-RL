2025-03-02 16:30:25,350 - train - INFO - Starting training for 10000 episodes with agent type: PPOAgent
2025-03-02 16:30:25,350 - train - INFO - Agent config: {'obs_dim': 35, 'action_dim': 37, 'hidden_dims': [256, 128, 64], 'learning_rate': 0.0003, 'min_learning_rate': 3e-05, 'gamma': 0.99, 'gae_lambda': 0.95, 'policy_clip': 0.2, 'value_coef': 0.5, 'entropy_coef': 0.002739378162004336, 'batch_size': 64, 'update_frequency': 2048, 'max_grad_norm': 0.5, 'update_counter': 93, 'step_counter': 603, 'total_training_steps': 1000000, 'current_lr': 0.0002765189162072148, 'device': 'cuda', 'memory_size': 605, 'avg_policy_loss': 0.0, 'avg_value_loss': 0.0, 'avg_entropy': 0.0, 'avg_reward': 7.802500000000001}
2025-03-02 16:30:27,503 - train - INFO - Episode 100/10000 | Reward: 2.24 | Length: 5.24 | Loss: 0.0000
2025-03-02 16:30:36,278 - train - INFO - Evaluation at episode 100: 3.00 reward, Win rate: 0.70
2025-03-02 16:30:38,144 - train - INFO - Episode 200/10000 | Reward: 2.26 | Length: 5.52 | Loss: 0.0000
2025-03-02 16:30:47,854 - train - INFO - Evaluation at episode 200: 3.00 reward, Win rate: 0.73
2025-03-02 16:30:50,453 - train - INFO - Episode 300/10000 | Reward: 2.63 | Length: 5.06 | Loss: 0.0000
2025-03-02 16:30:59,950 - train - INFO - Evaluation at episode 300: 4.00 reward, Win rate: 0.87
2025-03-02 16:31:02,062 - train - INFO - Episode 400/10000 | Reward: 2.59 | Length: 5.26 | Loss: 0.0000
2025-03-02 16:31:12,250 - train - INFO - Evaluation at episode 400: 5.00 reward, Win rate: 0.67
2025-03-02 16:31:14,307 - train - INFO - Episode 500/10000 | Reward: 2.51 | Length: 5.42 | Loss: 0.0000
2025-03-02 16:31:14,318 - train - INFO - Saved checkpoint to results/self_play\self_play_ppo_2p3d_20250302_160105\checkpoints\round_5\agent_episode_500
2025-03-02 16:31:24,344 - train - INFO - Evaluation at episode 500: -3.00 reward, Win rate: 0.73
2025-03-02 16:31:26,503 - train - INFO - Episode 600/10000 | Reward: 2.09 | Length: 5.45 | Loss: 0.0000
2025-03-02 16:31:37,359 - train - INFO - Evaluation at episode 600: 4.00 reward, Win rate: 0.70
2025-03-02 16:31:40,442 - train - INFO - Episode 700/10000 | Reward: 2.01 | Length: 5.47 | Loss: 0.0000
2025-03-02 16:31:52,208 - train - INFO - Evaluation at episode 700: 4.00 reward, Win rate: 0.73
2025-03-02 16:31:54,528 - train - INFO - Episode 800/10000 | Reward: 3.03 | Length: 5.12 | Loss: 0.0000
2025-03-02 16:32:06,294 - train - INFO - Evaluation at episode 800: -3.00 reward, Win rate: 0.80
2025-03-02 16:32:08,539 - train - INFO - Episode 900/10000 | Reward: 2.72 | Length: 4.90 | Loss: 0.0000
2025-03-02 16:32:19,594 - train - INFO - Evaluation at episode 900: 5.00 reward, Win rate: 0.73
2025-03-02 16:32:21,745 - train - INFO - Episode 1000/10000 | Reward: 2.44 | Length: 5.14 | Loss: 0.0000
2025-03-02 16:32:21,756 - train - INFO - Saved checkpoint to results/self_play\self_play_ppo_2p3d_20250302_160105\checkpoints\round_5\agent_episode_1000
2025-03-02 16:32:33,155 - train - INFO - Evaluation at episode 1000: -3.00 reward, Win rate: 0.73
2025-03-02 16:32:36,219 - train - INFO - Episode 1100/10000 | Reward: 2.28 | Length: 5.37 | Loss: 0.0000
2025-03-02 16:32:47,620 - train - INFO - Evaluation at episode 1100: 3.00 reward, Win rate: 0.70
2025-03-02 16:32:49,937 - train - INFO - Episode 1200/10000 | Reward: 2.69 | Length: 5.32 | Loss: 0.0000
2025-03-02 16:33:01,210 - train - INFO - Evaluation at episode 1200: 4.00 reward, Win rate: 0.73
2025-03-02 16:33:03,379 - train - INFO - Episode 1300/10000 | Reward: 2.45 | Length: 5.30 | Loss: 0.0000
2025-03-02 16:33:14,777 - train - INFO - Evaluation at episode 1300: 5.00 reward, Win rate: 0.67
2025-03-02 16:33:17,197 - train - INFO - Episode 1400/10000 | Reward: 2.51 | Length: 5.34 | Loss: 0.0000
2025-03-02 16:33:28,678 - train - INFO - Evaluation at episode 1400: 5.00 reward, Win rate: 0.80
2025-03-02 16:33:31,676 - train - INFO - Episode 1500/10000 | Reward: 2.43 | Length: 5.28 | Loss: 0.0000
2025-03-02 16:33:31,788 - train - INFO - Saved checkpoint to results/self_play\self_play_ppo_2p3d_20250302_160105\checkpoints\round_5\agent_episode_1500
2025-03-02 16:33:43,093 - train - INFO - Evaluation at episode 1500: 5.00 reward, Win rate: 0.83
2025-03-02 16:33:45,326 - train - INFO - Episode 1600/10000 | Reward: 2.62 | Length: 5.26 | Loss: 0.0000
2025-03-02 16:33:56,790 - train - INFO - Evaluation at episode 1600: 4.00 reward, Win rate: 0.67
2025-03-02 16:33:59,262 - train - INFO - Episode 1700/10000 | Reward: 2.67 | Length: 5.28 | Loss: 0.0000
2025-03-02 16:34:10,802 - train - INFO - Evaluation at episode 1700: 4.00 reward, Win rate: 0.83
2025-03-02 16:34:13,263 - train - INFO - Episode 1800/10000 | Reward: 2.22 | Length: 5.39 | Loss: 0.0000
2025-03-02 16:34:24,432 - train - INFO - Evaluation at episode 1800: 5.00 reward, Win rate: 0.70
2025-03-02 16:34:26,545 - train - INFO - Episode 1900/10000 | Reward: 3.11 | Length: 4.90 | Loss: 0.0000
2025-03-02 16:34:35,865 - train - INFO - Evaluation at episode 1900: 5.00 reward, Win rate: 0.77
2025-03-02 16:34:37,742 - train - INFO - Episode 2000/10000 | Reward: 2.73 | Length: 5.01 | Loss: 0.0000
2025-03-02 16:34:37,750 - train - INFO - Saved checkpoint to results/self_play\self_play_ppo_2p3d_20250302_160105\checkpoints\round_5\agent_episode_2000
2025-03-02 16:34:47,596 - train - INFO - Evaluation at episode 2000: 4.00 reward, Win rate: 0.77
2025-03-02 16:34:49,500 - train - INFO - Episode 2100/10000 | Reward: 2.80 | Length: 5.20 | Loss: 0.0000
2025-03-02 16:34:58,897 - train - INFO - Evaluation at episode 2100: -3.00 reward, Win rate: 0.77
2025-03-02 16:35:00,838 - train - INFO - Episode 2200/10000 | Reward: 3.07 | Length: 5.07 | Loss: 0.0000
2025-03-02 16:35:09,147 - train - INFO - Evaluation at episode 2200: 4.00 reward, Win rate: 0.80
2025-03-02 16:35:11,363 - train - INFO - Episode 2300/10000 | Reward: 2.25 | Length: 5.29 | Loss: 0.0000
2025-03-02 16:35:20,523 - train - INFO - Evaluation at episode 2300: 4.00 reward, Win rate: 0.93
2025-03-02 16:35:20,532 - train - INFO - Training stopped early by callback at episode 2300
2025-03-02 16:35:20,532 - train - INFO - Training completed!
2025-03-02 16:35:37,729 - train - INFO - Final evaluation: 2.80 reward
