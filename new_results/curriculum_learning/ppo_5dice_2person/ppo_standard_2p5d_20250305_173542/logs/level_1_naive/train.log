2025-03-05 17:37:27,825 - train - INFO - Starting training for 45000 episodes with agent type: PPOAgent
2025-03-05 17:37:27,825 - train - INFO - Agent config: {'obs_dim': 52, 'action_dim': 61, 'hidden_dims': [256, 128, 64], 'learning_rate': 0.0001, 'min_learning_rate': 3e-05, 'gamma': 0.99, 'gae_lambda': 0.97, 'policy_clip': 0.1, 'value_coef': 0.8, 'entropy_coef': 0.1370103092783505, 'batch_size': 256, 'update_frequency': 2048, 'max_grad_norm': 0.5, 'update_counter': 9, 'step_counter': 1544, 'total_training_steps': 1000000, 'current_lr': 9.994126977381723e-05, 'device': 'cuda', 'memory_size': 1702, 'avg_policy_loss': 0.0, 'avg_value_loss': 0.0, 'avg_entropy': 0.0, 'avg_reward': 12.223666666666666}
2025-03-05 17:37:30,427 - train - INFO - Episode 100/45000 | Reward: -4.87 | Length: 10.97 | Loss: 0.0000
2025-03-05 17:37:32,654 - train - INFO - Episode 200/45000 | Reward: -4.82 | Length: 11.29 | Loss: 0.0000
2025-03-05 17:37:35,329 - train - INFO - Episode 300/45000 | Reward: -4.69 | Length: 12.03 | Loss: 0.0000
2025-03-05 17:37:37,619 - train - INFO - Episode 400/45000 | Reward: -4.87 | Length: 11.36 | Loss: 0.0000
2025-03-05 17:37:40,290 - train - INFO - Episode 500/45000 | Reward: -4.81 | Length: 12.07 | Loss: 0.0000
2025-03-05 17:37:52,049 - train - INFO - Evaluation at episode 500: -5.00 reward, Win rate: 0.00
2025-03-05 17:37:54,720 - train - INFO - Episode 600/45000 | Reward: -4.80 | Length: 11.54 | Loss: 0.0000
2025-03-05 17:37:56,994 - train - INFO - Episode 700/45000 | Reward: -4.74 | Length: 11.52 | Loss: 0.0000
2025-03-05 17:37:59,712 - train - INFO - Episode 800/45000 | Reward: -4.70 | Length: 12.40 | Loss: 0.0000
2025-03-05 17:38:01,985 - train - INFO - Episode 900/45000 | Reward: -4.68 | Length: 11.65 | Loss: 0.0000
2025-03-05 17:38:04,719 - train - INFO - Episode 1000/45000 | Reward: -4.66 | Length: 12.37 | Loss: 0.0000
2025-03-05 17:38:16,993 - train - INFO - Evaluation at episode 1000: -5.00 reward, Win rate: 0.07
2025-03-05 17:38:17,002 - train - INFO - New best model with win rate 0.07 saved to new_results/curriculum_learning/ppo_5dice_2person\ppo_standard_2p5d_20250305_173542\checkpoints\level_1_naive\best_model_episode_1000
2025-03-05 17:38:19,376 - train - INFO - Episode 1100/45000 | Reward: -4.40 | Length: 12.22 | Loss: 0.0000
2025-03-05 17:38:22,276 - train - INFO - Episode 1200/45000 | Reward: -4.62 | Length: 11.89 | Loss: 0.0000
2025-03-05 17:38:25,363 - train - INFO - Episode 1300/45000 | Reward: -3.93 | Length: 12.31 | Loss: 0.0000
2025-03-05 17:38:28,013 - train - INFO - Episode 1400/45000 | Reward: -4.03 | Length: 12.72 | Loss: 0.0000
2025-03-05 17:38:30,873 - train - INFO - Episode 1500/45000 | Reward: -4.16 | Length: 12.62 | Loss: 0.0000
2025-03-05 17:38:43,100 - train - INFO - Evaluation at episode 1500: -5.00 reward, Win rate: 0.03
2025-03-05 17:38:45,874 - train - INFO - Episode 1600/45000 | Reward: -4.28 | Length: 12.42 | Loss: 0.0000
2025-03-05 17:38:48,789 - train - INFO - Episode 1700/45000 | Reward: -4.24 | Length: 12.91 | Loss: 0.0000
2025-03-05 17:38:51,588 - train - INFO - Episode 1800/45000 | Reward: -3.98 | Length: 12.45 | Loss: 0.0000
2025-03-05 17:38:54,084 - train - INFO - Episode 1900/45000 | Reward: -3.72 | Length: 12.58 | Loss: 0.0000
2025-03-05 17:38:56,951 - train - INFO - Episode 2000/45000 | Reward: -4.29 | Length: 12.51 | Loss: 0.0000
2025-03-05 17:39:09,929 - train - INFO - Evaluation at episode 2000: -5.00 reward, Win rate: 0.23
2025-03-05 17:39:09,939 - train - INFO - New best model with win rate 0.23 saved to new_results/curriculum_learning/ppo_5dice_2person\ppo_standard_2p5d_20250305_173542\checkpoints\level_1_naive\best_model_episode_2000
2025-03-05 17:39:12,967 - train - INFO - Episode 2100/45000 | Reward: -3.33 | Length: 12.61 | Loss: 0.0000
2025-03-05 17:39:15,586 - train - INFO - Episode 2200/45000 | Reward: -3.53 | Length: 12.94 | Loss: 0.0000
2025-03-05 17:39:18,485 - train - INFO - Episode 2300/45000 | Reward: -4.02 | Length: 12.93 | Loss: 0.0000
2025-03-05 17:39:21,047 - train - INFO - Episode 2400/45000 | Reward: -3.67 | Length: 12.50 | Loss: 0.0000
2025-03-05 17:39:23,982 - train - INFO - Episode 2500/45000 | Reward: -3.19 | Length: 12.33 | Loss: 0.0000
2025-03-05 17:39:36,703 - train - INFO - Evaluation at episode 2500: -5.00 reward, Win rate: 0.23
2025-03-05 17:39:39,731 - train - INFO - Episode 2600/45000 | Reward: -3.18 | Length: 12.62 | Loss: 0.0000
2025-03-05 17:39:42,273 - train - INFO - Episode 2700/45000 | Reward: -3.17 | Length: 12.91 | Loss: 0.0000
2025-03-05 17:39:45,214 - train - INFO - Episode 2800/45000 | Reward: -3.07 | Length: 13.29 | Loss: 0.0000
2025-03-05 17:39:47,805 - train - INFO - Episode 2900/45000 | Reward: -3.12 | Length: 12.91 | Loss: 0.0000
2025-03-05 17:39:50,841 - train - INFO - Episode 3000/45000 | Reward: -2.55 | Length: 13.60 | Loss: 0.0000
2025-03-05 17:40:03,884 - train - INFO - Evaluation at episode 3000: -5.00 reward, Win rate: 0.23
2025-03-05 17:40:06,973 - train - INFO - Episode 3100/45000 | Reward: -2.65 | Length: 13.48 | Loss: 0.0000
2025-03-05 17:40:09,796 - train - INFO - Episode 3200/45000 | Reward: -3.13 | Length: 13.80 | Loss: 0.0000
2025-03-05 17:40:12,774 - train - INFO - Episode 3300/45000 | Reward: -2.34 | Length: 13.59 | Loss: 0.0000
2025-03-05 17:40:15,774 - train - INFO - Episode 3400/45000 | Reward: -2.20 | Length: 13.67 | Loss: 0.0000
2025-03-05 17:40:18,535 - train - INFO - Episode 3500/45000 | Reward: -2.14 | Length: 13.77 | Loss: 0.0000
2025-03-05 17:40:32,499 - train - INFO - Evaluation at episode 3500: -5.00 reward, Win rate: 0.30
2025-03-05 17:40:32,506 - train - INFO - New best model with win rate 0.30 saved to new_results/curriculum_learning/ppo_5dice_2person\ppo_standard_2p5d_20250305_173542\checkpoints\level_1_naive\best_model_episode_3500
2025-03-05 17:40:35,465 - train - INFO - Episode 3600/45000 | Reward: -2.53 | Length: 13.39 | Loss: 0.0000
2025-03-05 17:40:38,567 - train - INFO - Episode 3700/45000 | Reward: -2.73 | Length: 13.90 | Loss: 0.0000
2025-03-05 17:40:41,383 - train - INFO - Episode 3800/45000 | Reward: -1.91 | Length: 13.50 | Loss: 0.0000
2025-03-05 17:40:44,625 - train - INFO - Episode 3900/45000 | Reward: -1.98 | Length: 13.45 | Loss: 0.0000
2025-03-05 17:40:47,788 - train - INFO - Episode 4000/45000 | Reward: -1.50 | Length: 13.72 | Loss: 0.0000
2025-03-05 17:41:01,837 - train - INFO - Evaluation at episode 4000: 4.00 reward, Win rate: 0.57
2025-03-05 17:41:01,847 - train - INFO - New best model with win rate 0.57 saved to new_results/curriculum_learning/ppo_5dice_2person\ppo_standard_2p5d_20250305_173542\checkpoints\level_1_naive\best_model_episode_4000
2025-03-05 17:41:05,017 - train - INFO - Episode 4100/45000 | Reward: -1.89 | Length: 14.12 | Loss: 0.0000
2025-03-05 17:41:08,246 - train - INFO - Episode 4200/45000 | Reward: -1.57 | Length: 14.22 | Loss: 0.0000
2025-03-05 17:41:11,155 - train - INFO - Episode 4300/45000 | Reward: -1.79 | Length: 14.22 | Loss: 0.0000
2025-03-05 17:41:13,816 - train - INFO - Episode 4400/45000 | Reward: -1.28 | Length: 13.96 | Loss: 0.0000
2025-03-05 17:41:16,989 - train - INFO - Episode 4500/45000 | Reward: -1.60 | Length: 14.05 | Loss: 0.0000
2025-03-05 17:41:30,957 - train - INFO - Evaluation at episode 4500: 2.00 reward, Win rate: 0.43
2025-03-05 17:41:34,092 - train - INFO - Episode 4600/45000 | Reward: -1.22 | Length: 14.30 | Loss: 0.0000
2025-03-05 17:41:37,086 - train - INFO - Episode 4700/45000 | Reward: -0.97 | Length: 13.87 | Loss: 0.0000
2025-03-05 17:41:39,824 - train - INFO - Episode 4800/45000 | Reward: -0.88 | Length: 14.24 | Loss: 0.0000
2025-03-05 17:41:42,755 - train - INFO - Episode 4900/45000 | Reward: -0.26 | Length: 13.98 | Loss: 0.0000
2025-03-05 17:41:45,711 - train - INFO - Episode 5000/45000 | Reward: 0.36 | Length: 14.00 | Loss: 0.0000
2025-03-05 17:41:59,998 - train - INFO - Evaluation at episode 5000: -5.00 reward, Win rate: 0.60
2025-03-05 17:42:00,008 - train - INFO - New best model with win rate 0.60 saved to new_results/curriculum_learning/ppo_5dice_2person\ppo_standard_2p5d_20250305_173542\checkpoints\level_1_naive\best_model_episode_5000
2025-03-05 17:42:02,876 - train - INFO - Episode 5100/45000 | Reward: -0.36 | Length: 14.13 | Loss: 0.0000
2025-03-05 17:42:05,866 - train - INFO - Episode 5200/45000 | Reward: 0.25 | Length: 13.72 | Loss: 0.0000
2025-03-05 17:42:09,075 - train - INFO - Episode 5300/45000 | Reward: 0.08 | Length: 13.93 | Loss: 0.0000
2025-03-05 17:42:12,039 - train - INFO - Episode 5400/45000 | Reward: 0.21 | Length: 14.16 | Loss: 0.0000
2025-03-05 17:42:15,151 - train - INFO - Episode 5500/45000 | Reward: 0.92 | Length: 13.83 | Loss: 0.0000
2025-03-05 17:42:28,316 - train - INFO - Evaluation at episode 5500: 4.00 reward, Win rate: 0.83
2025-03-05 17:42:28,326 - train - INFO - New best model with win rate 0.83 saved to new_results/curriculum_learning/ppo_5dice_2person\ppo_standard_2p5d_20250305_173542\checkpoints\level_1_naive\best_model_episode_5500
2025-03-05 17:42:31,374 - train - INFO - Episode 5600/45000 | Reward: 0.62 | Length: 13.89 | Loss: 0.0000
2025-03-05 17:42:33,978 - train - INFO - Episode 5700/45000 | Reward: 0.42 | Length: 14.22 | Loss: 0.0000
2025-03-05 17:42:36,799 - train - INFO - Episode 5800/45000 | Reward: 0.73 | Length: 13.72 | Loss: 0.0000
2025-03-05 17:42:39,692 - train - INFO - Episode 5900/45000 | Reward: 0.36 | Length: 13.93 | Loss: 0.0000
2025-03-05 17:42:42,302 - train - INFO - Episode 6000/45000 | Reward: 1.66 | Length: 14.01 | Loss: 0.0000
2025-03-05 17:42:55,691 - train - INFO - Evaluation at episode 6000: 3.00 reward, Win rate: 0.80
2025-03-05 17:42:58,568 - train - INFO - Episode 6100/45000 | Reward: 1.67 | Length: 13.67 | Loss: 0.0000
2025-03-05 17:43:01,412 - train - INFO - Episode 6200/45000 | Reward: 0.84 | Length: 13.39 | Loss: 0.0000
2025-03-05 17:43:04,047 - train - INFO - Episode 6300/45000 | Reward: 0.96 | Length: 14.20 | Loss: 0.0000
2025-03-05 17:43:06,954 - train - INFO - Episode 6400/45000 | Reward: 1.53 | Length: 14.08 | Loss: 0.0000
2025-03-05 17:43:09,837 - train - INFO - Episode 6500/45000 | Reward: 1.32 | Length: 13.65 | Loss: 0.0000
2025-03-05 17:43:23,404 - train - INFO - Evaluation at episode 6500: 4.00 reward, Win rate: 0.83
2025-03-05 17:43:26,228 - train - INFO - Episode 6600/45000 | Reward: 1.64 | Length: 13.78 | Loss: 0.0000
2025-03-05 17:43:29,072 - train - INFO - Episode 6700/45000 | Reward: 2.21 | Length: 13.54 | Loss: 0.0000
2025-03-05 17:43:31,965 - train - INFO - Episode 6800/45000 | Reward: 1.88 | Length: 13.74 | Loss: 0.0000
2025-03-05 17:43:34,472 - train - INFO - Episode 6900/45000 | Reward: 2.21 | Length: 13.35 | Loss: 0.0000
2025-03-05 17:43:37,239 - train - INFO - Episode 7000/45000 | Reward: 2.19 | Length: 13.39 | Loss: 0.0000
2025-03-05 17:43:50,289 - train - INFO - Evaluation at episode 7000: 4.00 reward, Win rate: 0.83
2025-03-05 17:43:53,347 - train - INFO - Episode 7100/45000 | Reward: 2.17 | Length: 13.77 | Loss: 0.0000
2025-03-05 17:43:55,865 - train - INFO - Episode 7200/45000 | Reward: 2.77 | Length: 13.34 | Loss: 0.0000
2025-03-05 17:43:58,649 - train - INFO - Episode 7300/45000 | Reward: 2.31 | Length: 13.40 | Loss: 0.0000
2025-03-05 17:44:01,472 - train - INFO - Episode 7400/45000 | Reward: 2.60 | Length: 13.44 | Loss: 0.0000
2025-03-05 17:44:03,868 - train - INFO - Episode 7500/45000 | Reward: 2.46 | Length: 12.84 | Loss: 0.0000
2025-03-05 17:44:16,965 - train - INFO - Evaluation at episode 7500: 2.00 reward, Win rate: 0.97
2025-03-05 17:44:16,976 - train - INFO - New best model with win rate 0.97 saved to new_results/curriculum_learning/ppo_5dice_2person\ppo_standard_2p5d_20250305_173542\checkpoints\level_1_naive\best_model_episode_7500
2025-03-05 17:44:16,976 - train - INFO - Win rate 0.97 is above threshold 0.90 (1/1)
2025-03-05 17:44:16,976 - train - INFO - Early stopping triggered at episode 7500 with win rate 0.97
2025-03-05 17:44:16,986 - train - INFO - Training completed!
2025-03-05 17:44:16,986 - train - INFO - Loading best model with win rate 0.97 for final evaluation
2025-03-05 17:44:40,995 - train - INFO - Final evaluation: 2.65 reward
